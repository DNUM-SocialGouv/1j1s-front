"use strict";(self.webpackChunk_1j1s_front_docs=self.webpackChunk_1j1s_front_docs||[]).push([[869],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>g});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var o=r.createContext({}),d=function(e){var t=r.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=d(e.components);return r.createElement(o.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,o=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=d(n),c=a,g=p["".concat(o,".").concat(c)]||p[c]||m[c]||l;return n?r.createElement(g,s(s({ref:t},u),{},{components:n})):r.createElement(g,s({ref:t},u))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,s=new Array(l);s[0]=c;var i={};for(var o in t)hasOwnProperty.call(t,o)&&(i[o]=t[o]);i.originalType=e,i[p]="string"==typeof e?e:a,s[1]=i;for(var d=2;d<l;d++)s[d]=n[d];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},629:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>s,default:()=>m,frontMatter:()=>l,metadata:()=>i,toc:()=>d});var r=n(7462),a=(n(7294),n(3905));const l={sidebar_label:"Liste des ADR",sidebar_position:1},s=void 0,i={unversionedId:"adr/ADR",id:"adr/ADR",title:"ADR",description:"02 Mars 2023",source:"@site/docs/adr/ADR.md",sourceDirName:"adr",slug:"/adr/",permalink:"/1j1s-front/docs/adr/",draft:!1,editUrl:"https://github.com/DNUM-SocialGouv/1j1s-front/tree/main/docs/docs/docs/adr/ADR.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_label:"Liste des ADR",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"\ud83d\udcd3 ADRs",permalink:"/1j1s-front/docs/category/-adrs"},next:{title:"\u2696\ufe0f Conventions",permalink:"/1j1s-front/docs/category/\ufe0f-conventions"}},o={},d=[],u={toc:d},p="wrapper";function m(e){let{components:t,...n}=e;return(0,a.kt)(p,(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"02 Mars 2023")),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Date"),(0,a.kt)("th",{parentName:"tr",align:null},"D\xe9cision"),(0,a.kt)("th",{parentName:"tr",align:null},"Pr\xe9cisions"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"08-06-2022"),(0,a.kt)("td",{parentName:"tr",align:null},"Utilisation de la librairie ",(0,a.kt)("a",{parentName:"td",href:"https://github.com/markedjs/marked"},"markedjs")),(0,a.kt)("td",{parentName:"tr",align:null},"Cette librairie permet de parser du markdown et le convertir en format HTML. Nous avons fait le choix de cette librairie pour sa l\xe9g\xe8ret\xe9, sa simplicit\xe9 d'utilisation, ainsi que son nombre de t\xe9l\xe9chargements hebdomadaires.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"07-07-2022"),(0,a.kt)("td",{parentName:"tr",align:null},"Utilisation du pr\xe9processeur ",(0,a.kt)("a",{parentName:"td",href:"https://sass-lang.com"},"sass")),(0,a.kt)("td",{parentName:"tr",align:null},"Ce pr\xe9processeur permet d'apporter des fonctionnalit\xe9s manquantes \xe0 CSS (variables, mixins, fonctions). Nous l'utilisons pour favoriser la composition dans le code. Sass est support\xe9 par NextJS et compatible avec CSS Modules.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"15-07-2022"),(0,a.kt)("td",{parentName:"tr",align:null},"Utilisation de la librairie ",(0,a.kt)("a",{parentName:"td",href:"https://www.npmjs.com/package/classnames"},"classnames")),(0,a.kt)("td",{parentName:"tr",align:null},"Cette librairie utilitaire simplifie les jonctions conditionnelles de classes. L\xe9g\xe8re et populaire, nous l'utilisons notamment pour am\xe9liorer la lecture du code.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"19-07-2022"),(0,a.kt)("td",{parentName:"tr",align:null},"Pattern Either pour la gestion des erreurs ",(0,a.kt)("a",{parentName:"td",href:"https://www.thoughtworks.com/insights/blog/either-data-type-alternative-throwing-exceptions"},"why either ?")),(0,a.kt)("td",{parentName:"tr",align:null},"Pour r\xe9sumer ce pattern permet d'\xe9viter d'\xeatre un peu perdu dans les try/catch et le suite du flow quand une exception est lev\xe9 on a choisi de s'orienter sur ce pattern. ",(0,a.kt)("br",null)," Cela permet d'avoir un retour claire avec soit une bonne r\xe9ponse et un r\xe9sultat, soit une mauvaise r\xe9ponse et une erreur.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"19-07-2022"),(0,a.kt)("td",{parentName:"tr",align:null},"Sortir les fonctions utilitaires des composants pour \xe9viter trop de logique dans le composant"),(0,a.kt)("td",{parentName:"tr",align:null},"Un exemple ici : r\xe9cup\xe9rerLibell\xe9DepuisValeur.utils.ts ",(0,a.kt)("br",null)," Cela permet d'\xe9dulcorer le code des composants et de tester plus facilement unitaires de la logique.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"10-11-2022"),(0,a.kt)("td",{parentName:"tr",align:null},"Utilisation de cypress pour tester les moteurs de recherche, l'acc\xe8s \xe0 une ressource et les formulaires"),(0,a.kt)("td",{parentName:"tr",align:null},"Douleur rencontrer lors de monter de version de certaines libs et on sera plus sera serein lors de nos prochaines MEPs")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"02-12-2022"),(0,a.kt)("td",{parentName:"tr",align:null},"Autorisation des installations des d\xe9pendances avec mise \xe0 jour du patch seulement"),(0,a.kt)("td",{parentName:"tr",align:null},"Afin d'\xe9viter les mauvaises surprises avec des mises \xe0 jour de mineur sur les libraires ne respectant pas le semantic versioning (@meilisearch/instant-meilisearch), les installations de d\xe9pendances avec mises \xe0 jour de mineur ne sont plus automatiques et doivent \xeatre v\xe9rifi\xe9es manuellement.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"02-12-2022"),(0,a.kt)("td",{parentName:"tr",align:null},"Pas de ",(0,a.kt)("inlineCode",{parentName:"td"},"npm run test")," dans les hooks git"),(0,a.kt)("td",{parentName:"tr",align:null},"L'ex\xe9cution des tests prenant du temps, seul le linter est jou\xe9 dans les git hooks")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"28-12-2022"),(0,a.kt)("td",{parentName:"tr",align:null},"Mise en place de cypress sur la CI pour chaque PR"),(0,a.kt)("td",{parentName:"tr",align:null},"Split des githubs actions pour les tests unitaires et e2e pour gagner du temps sur la CI. ",(0,a.kt)("br",null)," Pour le moment au 29 d\xe9cembre le format de sortie sur la console est tr\xe8s moche il faudrait voir au futur maj si ca se corrige sinon faudra bidouill\xe9")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"10-02-2023"),(0,a.kt)("td",{parentName:"tr",align:null},"Typage des composants g\xe9n\xe9riques"),(0,a.kt)("td",{parentName:"tr",align:null},"Afin d'unifier nos m\xe9thodes de typage de composants g\xe9n\xe9riques (Link, Button, etc.), les interfaces de ceux-ci sont \xe9tendues avec le type React.ComponentPropsWithoutRef. Entre chevron devra figur\xe9 le nom de l'\xe9l\xe9ment sur lequel le ",(0,a.kt)("inlineCode",{parentName:"td"},"rest")," sera appliqu\xe9.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"21-02-2023"),(0,a.kt)("td",{parentName:"tr",align:null},"Mise en cache des appels aux APIs G\xe9o et Adresse"),(0,a.kt)("td",{parentName:"tr",align:null},"Notre nombre d'appels HTTP vers les API G\xe9o et Adresse est aujourd'hui limit\xe9 et cette limite est r\xe9guli\xe8rement atteinte. Afin de r\xe9duire les risques d'atteindre cette limite, nous mettons en cache le r\xe9sultat des requ\xeates vers ces APIs.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"22-02-2023"),(0,a.kt)("td",{parentName:"tr",align:null},"G\xe9n\xe9ration du sitemap.xml et robots.txt"),(0,a.kt)("td",{parentName:"tr",align:null},"Les fichiers ",(0,a.kt)("inlineCode",{parentName:"td"},"robots.txt")," et ",(0,a.kt)("inlineCode",{parentName:"td"},"sitemap.xml")," ne comportant pas de logique d'affichage, leur contenu est g\xe9n\xe9r\xe9 c\xf4t\xe9 BFF via les endpoints ",(0,a.kt)("inlineCode",{parentName:"td"},"/robots")," et ",(0,a.kt)("inlineCode",{parentName:"td"},"/sitemap"),". Ils sont accessibles pour les web crawlers gr\xe2ce \xe0 la configuration de r\xe9\xe9criture des routes dans ",(0,a.kt)("inlineCode",{parentName:"td"},"/config/rewrites.js"),".")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"02-03-2023"),(0,a.kt)("td",{parentName:"tr",align:null},"Pas de tests sur le localStorage et le sessionStorage dans la fonctionnalit\xe9 d\xe9p\xf4t offre de stage"),(0,a.kt)("td",{parentName:"tr",align:null},"malgr\xe9 les mocks de sessionStorage et localStorage les tests dans rtl ne fonctionnent pas comme attendu. La fonctionnalit\xe9 sera donc test\xe9 exclusivement avec les tests end-to-end.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"25-04-2023"),(0,a.kt)("td",{parentName:"tr",align:null},"Pas d'accent dans les noms de variable, de fichier et dans le CSS"),(0,a.kt)("td",{parentName:"tr",align:null},"Cette r\xe8gle ne concerne pas le contenu des strings, comme par exemple les noms des tests ou contenu affich\xe9. Les accents causent probl\xe8me lors des checkouts ou refactors automatiques d'IntelliJ.")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"25-04-2023"),(0,a.kt)("td",{parentName:"tr",align:null},"L'imbrication dans le SCSS se fait par imbrication de classe (e.g. : ",(0,a.kt)("inlineCode",{parentName:"td"},".page { & .element {} }")," ou ",(0,a.kt)("inlineCode",{parentName:"td"},".page { & h1 {} }"),")."),(0,a.kt)("td",{parentName:"tr",align:null},"Interdit de produire des noms de classe concat\xe9n\xe9s (e.g. : ",(0,a.kt)("inlineCode",{parentName:"td"},".page { &Element {} }")," ou ",(0,a.kt)("inlineCode",{parentName:"td"},".page { &__Element {} }"),").")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"09-05-2023"),(0,a.kt)("td",{parentName:"tr",align:null},"Le pr\xe9fixe des fixtures est en anglais (e.g. : ",(0,a.kt)("inlineCode",{parentName:"td"},"anAnnonceDeLogement"),")."),(0,a.kt)("td",{parentName:"tr",align:null},"Pour avoir un nom de fixture homog\xe8ne nous avons choisi de pr\xe9fixer toutes nos fixtures par ",(0,a.kt)("inlineCode",{parentName:"td"},"a")," ou ",(0,a.kt)("inlineCode",{parentName:"td"},"an"))))))}m.isMDXComponent=!0}}]);