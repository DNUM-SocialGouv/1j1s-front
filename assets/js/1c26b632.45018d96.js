"use strict";(self.webpackChunk_1j1s_front_docs=self.webpackChunk_1j1s_front_docs||[]).push([[368],{500:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>o});var t=s(4848),r=s(8453);const i={},a="Ne pas utiliser as unknown as MyClass",l={id:"adr/2023-05-23.ne-pas-utiliser-as-unknown-as-myclass",title:"Ne pas utiliser as unknown as MyClass",description:"23 mai 2023",source:"@site/docs/adr/2023-05-23.ne-pas-utiliser-as-unknown-as-myclass.md",sourceDirName:"adr",slug:"/adr/2023-05-23.ne-pas-utiliser-as-unknown-as-myclass",permalink:"/1j1s-front/docs/adr/2023-05-23.ne-pas-utiliser-as-unknown-as-myclass",draft:!1,unlisted:!1,editUrl:"https://github.com/DNUM-SocialGouv/1j1s-front/tree/main/docs/docs/docs/adr/2023-05-23.ne-pas-utiliser-as-unknown-as-myclass.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Format des ADR",permalink:"/1j1s-front/docs/adr/2023-05-23.format-adr"},next:{title:"Mocker les m\xe9thodes des interfaces par spyOn",permalink:"/1j1s-front/docs/adr/2023-06-06.mocker-les-methodes-des-interfaces-par-spyon"}},c={},o=[{value:"TL;DR",id:"tldr",level:2},{value:"Contributeurs",id:"contributeurs",level:2},{value:"Statut",id:"statut",level:2},{value:"Contexte",id:"contexte",level:2},{value:"D\xe9cision",id:"d\xe9cision",level:2},{value:"Cons\xe9quences",id:"cons\xe9quences",level:2}];function u(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsxs)(n.h1,{id:"ne-pas-utiliser-as-unknown-as-myclass",children:["Ne pas utiliser ",(0,t.jsx)(n.code,{children:"as unknown as MyClass"})]})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"23 mai 2023"})}),"\n",(0,t.jsx)(n.h2,{id:"tldr",children:"TL;DR"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Pr\xe9f\xe9rer les interfaces, l'abstraction et la s\xe9paration des responsabilit\xe9s."})}),"\n",(0,t.jsx)(n.h2,{id:"contributeurs",children:"Contributeurs"}),"\n",(0,t.jsx)(n.p,{children:"Suxue Li, Julie Brunetto, Guillaume Moizan, Gauthier Fiorentino, Dorian De Rosa"}),"\n",(0,t.jsx)(n.h2,{id:"statut",children:"Statut"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Accept\xe9"})}),"\n",(0,t.jsx)(n.h2,{id:"contexte",children:"Contexte"}),"\n",(0,t.jsxs)(n.p,{children:["On veut \xe9viter d'avoir des casts en ",(0,t.jsx)(n.code,{children:"unknown"})," comme \xe7a :"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"return {\n    envoyerAnalyticsPageVue: jest.fn(),\n    isAnalyticsAutoris\xe9: jest.fn(() => false),\n} as unknown as AnalyticsService;\n"})}),"\n",(0,t.jsx)(n.p,{children:"Ces casts permettent de forcer le typage m\xeame lorsque l'objet ne respecte pas le contrat de la class, par exemple :"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"return {\n    envoyerAnalyticsPageVue: jest.fn(),\n} as unknown as AnalyticsService;\n// pas d'erreur de typage malgr\xe9 le manque d'une m\xe9thode\n\nreturn {\n  envoyerAnalyticsPageVue: jest.fn(),\n  isAnalyticsAutoris\xe9: jest.fn(() => false),\n  truc: () => 'test'\n} as unknown as AnalyticsService;\n// pas d'erreur malgr\xe9 la m\xe9thode superflue\n\nreturn {\n  envoyerAnalyticsPageVue: jest.fn(),\n  isAnalyticsAutoris\xe9: () => 'toto',\n} as unknown as AnalyticsService;\n// pas d'erreur malgr\xe9 le prototype de la m\xe9thode incoh\xe9rent avec son impl\xe9mentation\n"})}),"\n",(0,t.jsx)(n.h2,{id:"d\xe9cision",children:"D\xe9cision"}),"\n",(0,t.jsxs)(n.p,{children:["Ne pas utiliser ",(0,t.jsx)(n.code,{children:"as unknown as MyClass"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"cons\xe9quences",children:"Cons\xe9quences"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Si la douleur vient de champs priv\xe9s que typescript demande d'impl\xe9menter ==> passer par une interface n'exposant que les champs publics de la classe"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"class Toto {\n  public truc() {}\n  private machin() {}\n}\n\n// devient\n\ninterface Toto {\n  truc(): void;\n}\nclass TotoImplementation implements Toto {\n  public truc() {}\n  private machin() {}\n}\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Si la douleur vient du fait qu'on ne se sert que d'une partie de la classe ==> S\xe9parer la classe en plusieurs classes \xe0 responsabilit\xe9s uniques"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"class MonService {\n  public doStuff1() {}\n  public doStuff2() {}\n}\n\n// devient\n\nclass MonServiceStuff1 {\n  public execute() {}\n}\nclass MonServiceStuff2 {\n  public execute() {}\n}\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Si la douleur vient de l'utilisation d'une biblioth\xe8que externe ==> Abstraire le typage avec uniquement les champs de la biblioth\xe8que utilis\xe9s"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"function Truc(response: AxiosResponse<string>): void {}\n\n// devient\n\ntype TrucResponse = { data: string }\nfunction Truc(response: TrucResponse): void {}\n"})})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var t=s(6540);const r={},i=t.createContext(r);function a(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);