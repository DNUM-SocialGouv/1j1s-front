# Mocker les méthodes des interfaces par override à l'instanciation

_06 juin 2023_

## TL;DR

Mocker les méthodes des interfaces par override à l'instanciation (ex : `anHttpClientService({ get: jest.fn(async () => ({...}) })`)

## Contributeurs

Suxue Li, Julie Brunetto, Guillaume Moizan, Gauthier Fiorentino, Dorian De Rosa, Fred Nobre

## Statut

*Accepté*

## Contexte
Plusieurs manières de mocker / stubber une dépendance, exemple avec la méthode `get` sur le `httpClientService` :
- `(httpClientService.get as jest.Mock).mockResolvedValue(...)` 
- `jest.spyOn(httpClientService, 'get').mockResolvedValue(...)`
- `anHttpClientService({ get: jest.fn(async () => ({...}) })`

Après discussion, l'équipe s'accorde sur : 
- `(httpClientService.get as jest.Mock).mockResolvedValue(...)` -> Ne plus le faire car plus besoin de redéfinir manuellement le type

L'équipe est divisée entre le `jest.spyOn` et l'override à l'instanciation de la classe, pour des raisons de préférences subjectives de lecture.

## Décision

Pour éviter d'avoir deux manières de faire, la préférence est donnée à la méthode :
`anHttpClientService({ get: jest.fn(async () => ({...}) })` (= override des méthodes par défaut à l'instanciation de la classe)


L'équipe s'accorde aussi sur le fait de ne pas initialiser des méthodes / valeurs testées dans un `beforeEach` pour garder des tests
autoportants.

## Conséquences

Les :
- `(httpClientService.get as jest.Mock).mockResolvedValue(...)`
- `jest.spyOn(httpClientService, 'get').mockResolvedValue(...)`

et équivalent sur autres interfaces / méthodes sont dépréciés 

## Autres pistes explorées
